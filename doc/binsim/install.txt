Installation
============

This instructions guides you how to install the Two!Ears Binaural Simulator, for
installing the whole Two!Ears Auditory Model refer to the :doc:`Installation
guide <../intro/install>`.

Dependencies
------------

In order to work with the Two!Ears :doc:`module <../intro/modules>` you have to
install the following other modules first:

* Two!Ears Main
* Two!Ears Tools
* Two!Ears Database (optional)

Linux/Mac
---------

Prerequisites
~~~~~~~~~~~~~

First you have to ensure some prerequisites:

* Debian or Debian-based Linux operating system (e.g. Ubuntu) recommended
* MATLAB + mex-compiler
* packages (install with apt-get, aptitude, synaptic, macports, ...)

  * **make**
  * **g++** (at least version 4.7.3)
  * **libsndfile1-dev**
  * **libxml2-dev**
  * **libfftw3-dev**

* optional: get SoundScape Renderer (location will be denoted as ``SSR_DIR``)
  ::

      git clone https://github.com/TWOEARS/twoears-ssr.git SSR_DIR
      git checkout origin/master -b master

MEX Binaries
~~~~~~~~~~~~

Alternative 1
^^^^^^^^^^^^^

* use the pre-compiled binaries provided inside ``src/mex``

Alternative 2 (requires optional prerequisites)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

* switch to directory containing the mex-files
  ::

      cd SSR_DIR/mex/

* if you are using a Mac and installed MATLAB at ``/Applications/MATLAB_R2013a.app``
  ::

      export PATH="/Applications/MATLAB_R2013a.app/bin:$PATH"
      export CPPFLAGS="-I/Applications/MATLAB_R2013a.app/extern/include"

* generate mex-files
  ::

      make matlab

* If you get an error saying that the version of ``GLIBCXX`` is not correct this
  is due to the usage of the MATLAB provided ``libstdc++`` which is for an older
  gcc version. You can solve this by deleting linking it to your system
  ``libstdc++`` via
  ::

      ln -s /usr/lib/x86_64-linux-gnu/libstdc++.so.<LIBSTDC-VERSION> \
            /usr/local/MATLAB/MATLAB-VERSION/bin/glnxa64/libstdc++.so.6

* open Matlab and add ``SSR_DIR/mex/`` to MATLAB-path using ``pathtool`` or ``addpath``

That's all, now you should be able to :doc:`use the Two!Ears Binaural Simulator <usage>`.


Windows 7 64bit
---------------

Prerequisites
~~~~~~~~~~~~~

First you have to ensure some prerequisites:

* get SoundScape Renderer (location will be denoted as ``SSR_DIR``)
  ::

      git clone https://github.com/TWOEARS/twoears-ssr.git SSR_DIR
      git checkout origin/win64 -b win64

* add ``SSR_DIR\3rdparty\win64\bin`` to ``PATH`` environment variable (`HOWTO`_)

* optional: get `MinGW 64bit`_, location will be denoted as ``MINGW_DIR``
* optional: get `MSYS`_, location will be denoted as ``MSYS_DIR``


.. _HOWTO: http://www.computerhope.com/issues/ch000549.htm
.. _MinGW 64bit: http://sourceforge.net/projects/mingw-w64/files/Toolchains%20targetting%20Win64/Personal%20Builds/mingw-builds/4.8.2/threads-win32/seh/x86_64-4.8.2-release-win32-seh-rt_v3-rev4.7z/download
.. _MSYS: http://sourceforge.net/projects/mingw-w64/files/External%20binary%20packages%20%28Win64%20hosted%29/MSYS%20%2832-bit%29/MSYS-20111123.zip/download

MEX Binaries
~~~~~~~~~~~~

Alternative 1
^^^^^^^^^^^^^

* use the pre-compiled binaries provided inside ``src/mex``

Alternative 2 (requires optional prerequisites)
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

* edit ``SSR_DIR/mex/win64/Makefile`` and set the ``MATLABROOT`` to the location of your systems MATLAB
* edit or create ``MSYS_DIR\etc\fstab`` and add mounts for ``MINGW_DIR`` and ``SSR_DIR``
  ::

      MINGW_DIR    /mingw
      SSR_DIR      /ssr

* start the shell by executing ``MSYS_DIR/msys.bat``
* switch to directory and compile sources
  ::

      cd /ssr/mex/win64
      make

* open Matlab and add ``SSR_DIR/mex/`` to MATLAB-path using ``pathtool`` or ``addpath``

That's all, now you should be able to :doc:`use the Two!Ears Binaural Simulator <usage>`.

.. vim: filetype=rst spell:
